\documentclass{beamer}

\author[D. Abercrombie]{
  Daniel Abercrombie
}

\title{\bf \sffamily State of Workflow Web Tools Storage}
\date{\today}

\usecolortheme{dove}

\usepackage[absolute,overlay]{textpos}
\usefonttheme{serif}
\usepackage{appendixnumberbeamer}
\usepackage{isotope}
\usepackage{hyperref}
\usepackage[english]{babel}
\usepackage{amsmath}
\setbeamerfont{frametitle}{size=\Large,series=\bf\sffamily}
\setbeamertemplate{frametitle}[default][center]
\usepackage{siunitx}
\usepackage{tabularx}
\usepackage{makecell}

\setbeamertemplate{navigation symbols}{}
\usepackage{graphicx}
\usepackage{color}
\setbeamertemplate{footline}[text line]{\parbox{1.083\linewidth}{\footnotesize \hfill \insertshortauthor \hfill \insertpagenumber /\inserttotalframenumber}}
\setbeamertemplate{headline}[text line]{\parbox{1.083\linewidth}{\footnotesize \hspace{-0.083\linewidth} \textcolor{blue}{\sffamily \insertsection \hfill \insertsubsection}}}

\IfFileExists{/Users/dabercro/GradSchool/Presentations/MIT-logo.pdf}
             {\logo{\includegraphics[height=0.5cm]{/Users/dabercro/GradSchool/Presentations/MIT-logo.pdf}}}
             {\logo{\includegraphics[height=0.5cm]{/home/dabercro/MIT-logo.pdf}}}

\usepackage{changepage}

\newcommand{\beginbackup}{
  \newcounter{framenumbervorappendix}
  \setcounter{framenumbervorappendix}{\value{framenumber}}
}
\newcommand{\backupend}{
  \addtocounter{framenumbervorappendix}{-\value{framenumber}}
  \addtocounter{framenumber}{\value{framenumbervorappendix}}
}

\graphicspath{{figs/}}

\begin{document}

\begin{frame}[nonumbering]
  \titlepage
\end{frame}

\begin{frame}
  \frametitle{Information Stored in SQL (fixed schema)}
  \begin{itemize}
  \item Historic error information (updated every 6 hours): \\
    \textcolor{blue}{UNIQUE KEY}, TASK NAME, EXIT CODE,
    SITE, NUMBER OF ERRORS, \textcolor{red}{SITE READINESS} \\
    \begin{itemize}
    \item \textcolor{blue}{
      The unique key is generated by combining the task name, site, and exit code.
      It is used to ensure that historic data is only entered once for this combination.
    }
    \item \textcolor{red}{Site readiness is checked at the time of the update}
    \item One missing thing that would be useful is drain status
    \end{itemize}
  \item Past reasons: \\
    \textcolor{blue}{SHORT REASON}, \textcolor{red}{LONG REASON}
    \begin{itemize}
    \item \textcolor{blue}{Short reason appears in the drop down menus}
    \item \textcolor{red}{
      The long reason is planned to be used for explanations to the operator or requester
    }
    \end{itemize}
  \item \textcolor{gray}{User info:} \\
    \textcolor{gray}{
      USERNAME, EMAIL, HASHED PASSWORD, \\
      STRING FOR VERIFYING, BOOL IS VERIFIED
    }
    \begin{itemize}
    \item \textcolor{gray}{Not needed if we move to SSO, and}
      \textcolor{green}{not used in learning}
    \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Actions: Non-Relational Data}
  Currently, actions are just stored in JSON files \\
  Performance can easily be improved  with MongoDB
  \begin{itemize}
  \item All actions have USERNAME, \textcolor{blue}{TIMESTAMP}, WORKFLOW,
    ACTION, \textcolor{orange}{REASONS (list of long reasons)}, \textcolor{red}{PARAMETERS}
  \item \textcolor{blue}{Timestamp is just date,
    so users can overwrite submissions from earlier in the day easily.}
  \item \textcolor{red}{Parameters depends on the action \\
    These primarily are what make SQL unusable}
    \begin{itemize}
    \item Kill and Clone has: splitting, memory
    \item ACDC has: tasks (as keys)
      \begin{itemize}
        Each task has: xrootd, secondary, splitting, memory, sites
      \end{itemize}
    \item Other Action has: other
    \end{itemize}
  \item \textcolor{orange}{
    Lists of strings, like the reasons, \\
    also make SQL trickier to use}
  \end{itemize}
\end{frame}

\end{document}
